/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, Output, EventEmitter, HostListener, forwardRef } from '@angular/core';
import { Base } from '../../../models/src/base';
import { ControlContainer, NgForm } from '@angular/forms';
import * as zxcvbn_ from 'zxcvbn';
// Awkward necessary workaround due to bug in build tools
// https://github.com/jvandemo/generator-angular2-library/issues/221#issuecomment-355945207
/** @type {?} */
const zxcvbn = zxcvbn_;
/**
 * Interface for passing in error messages
 * Example:
 *  errorMessages = {
 *       required: this.componentLabel + ' is required.',
 *       minLength: this.componentLabel + ' must be ' + this.minLen + ' characters.',
 *       criteria: this.componentLabel + ' does not meet password criteria.'
 *     }
 * @record
 */
export function PasswordErrorMsg() { }
if (false) {
    /** @type {?|undefined} */
    PasswordErrorMsg.prototype.required;
    /** @type {?|undefined} */
    PasswordErrorMsg.prototype.minLength;
    /** @type {?|undefined} */
    PasswordErrorMsg.prototype.criteria;
}
/**
 * PasswordComponent is a text input for a user's password. It includes:
 *
 * - A password strength bar
 * - Minimum length validations
 *
 * Note - if your application has requirements to check things like username is not
 * present in password, we recommend doing this in the (passwordChange) callback.
 *
 * \@example
 *       <common-password componentLabel="{{newPwdLabel}}"
 *                      [showPasswordStrength]="true"
 *                      [minLen]="pwdMinLen"
 *                      [pwdCriteria]="pwdValidChars"
 *                      [password]="data.password"
 *                      (passwordChange)="setNewPassword($event)"></common-password>
 *
 * @export
 */
export class PasswordComponent extends Base {
    constructor() {
        super();
        // Inputs for the component
        this.label = 'Password';
        this.isRequired = true;
        this.isDisabled = false;
        this.minLen = '8';
        this.maxLen = '32';
        this.showPasswordStrength = false;
        this.objectID = 'password_' + this.objectId;
        // Output from the component
        this.passwordChange = new EventEmitter();
        this.blurEvent = new EventEmitter();
        // Flag for the fa-eye to show or hide password
        this.hideValue = true;
        this.strengthPercentage = 0;
        // default messages
        this.requiredMsgSeg = ' is required.';
        this.minLenMsgSeg1 = ' must be at least ';
        this.minLenMsgSeg2 = ' characters in length.';
        this.criteriaMsg = ' contains invalid characters.';
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        // Set default messages
        this.errMsg = {
            required: this.label + this.requiredMsgSeg,
            minLength: this.label + this.minLenMsgSeg1 + this.minLen + this.minLenMsgSeg2,
            criteria: this.label + this.criteriaMsg
        };
        // Replace default message if provided
        if (this.errorMessages) {
            if (this.errorMessages.required) {
                this.errMsg.required = this.errorMessages.required;
            }
            if (this.errorMessages.minLength) {
                this.errMsg.minLength = this.errorMessages.minLength;
            }
            if (this.errorMessages.criteria) {
                this.errMsg.criteria = this.errorMessages.criteria;
            }
        }
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if (changes.password && this.password) {
            // Check strength of password
            this.pswdStrength = this.getPasswordStrength(this.password);
            this.strengthPercentage = ((this.pswdStrength + 1) / 5) * 100;
        }
    }
    /**
     * Passes the value entered back to the calling component
     * @param {?} password value the was entered by
     * @return {?}
     */
    setPassword(password) {
        this.passwordChange.emit(password);
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onInputBlur($event) {
        console.log('onBlur: ', event);
        this.blurEvent.emit(event);
    }
    // Prevent user from pasting data into the text box
    /**
     * @param {?} event
     * @return {?}
     */
    onPaste(event) {
        return false;
    }
    /**
     * Get the strength of the password
     *    0 = too guessable: risky password. (guesses < 10^3)
     *    1 = very guessable: protection from throttled online attacks. (guesses < 10^6)
     *    2 = somewhat guessable: protection from unthrottled online attacks. (guesses < 10^8)
     *    3 = safely unguessable: moderate protection from offline slow-hash scenario. (guesses < 10^10)
     *    4 = very unguessable: strong protection from offline slow-hash scenario. (guesses >= 10^10)
     *
     *  https://github.com/dropbox/zxcvbn
     * @private
     * @param {?} password
     * @return {?}
     */
    getPasswordStrength(password) {
        // Password strength feedback
        /** @type {?} */
        const pswdFeedback = zxcvbn(password);
        return pswdFeedback.score;
    }
}
PasswordComponent.decorators = [
    { type: Component, args: [{
                selector: 'common-password',
                template: "<label class=\"control-label\" for=\"{{objectID}}\">{{label}}</label>\n<input #pswdRef=\"ngModel\"\n       type=\"{{hideValue? 'password': 'text'}}\"\n       class=\"form-control password-field\"\n       name=\"{{objectID}}\"\n       id=\"{{objectID}}\"\n       [ngModel]=\"password\"\n       (ngModelChange)=\"setPassword($event)\"\n       (blur)=\"onInputBlur($event)\"\n       [pattern]=\"pwdCriteria\"\n       [required]=\"isRequired\"\n       [minlength]=\"minLen\"\n       [maxlength]=\"maxLen\"\n       [disabled]=\"isDisabled\" />\n<span class=\"fa fa-fw {{hideValue? 'fa-eye' : 'fa-eye-slash'}} password-field-icon\"\n      (click)='hideValue = !hideValue'></span>\n<div *ngIf='password && showPasswordStrength'>\n<!-- The progress bar -->\n  <div class=\"progress password-strength-bar\" >\n    <div class=\"progress-bar {{pswdStrength >= 4? 'bg-success' : (pswdStrength >= 3? 'bg-warning' : 'bg-danger')}}\"\n        role=\"progressbar\"\n        [style.width]='strengthPercentage + \"%\"'\n        [attr.aria-valuenow]=\"strengthPercentage\"\n        aria-valuemin=\"0\"\n        aria-valuemax=\"100\">\n    </div>\n  </div>\n  <span class=\"password-progress-label {{pswdStrength >= 4? 'text-success' : (pswdStrength >= 3? 'text-warning' : 'text-danger')}}\"></span>\n</div>\n<!-- Error messages for component -->\n<div *ngIf=\"!pswdRef.disabled && (pswdRef.touched || pswdRef.dirty)\"\n    role=\"alert\"\n    class='error-container'\n    aria-live=\"assertive\">\n  <div class=\"text-danger\" *ngIf=\"pswdRef?.errors?.required\">\n    {{errMsg.required}}\n  </div>\n  <div class=\"text-danger\" *ngIf=\"pswdRef?.errors?.minlength\">\n      {{errMsg.minLength}}\n  </div>\n  <div class=\"text-danger\" *ngIf=\"pswdRef?.errors?.pattern && !pswdRef?.errors?.minlength\">\n      {{errMsg.criteria}}\n  </div>\n</div>\n\n",
                /* Re-use the same ngForm that it's parent is using. The component will show
                   * up in its parents `this.form`, and will auto-update `this.form.valid`
                   */
                viewProviders: [{ provide: ControlContainer, useExisting: forwardRef((/**
                         * @return {?}
                         */
                        () => NgForm)) }],
                styles: [".password-field-icon{float:right;margin-left:-25px;margin-top:-25px;margin-right:.5rem;position:relative;z-index:2}.password-field{padding-right:2rem}.password-strength-bar{min-width:0;max-width:75%;height:.5rem;margin-top:1em}.password-progress-label{float:right;margin-left:-15px;margin-top:-15px;position:relative;z-index:2}.password-strength-bar+.text-success::after{content:'Good'}.password-strength-bar+.text-warning::after{content:'OK'}.password-strength-bar+.text-danger::after{content:'Bad'}input{width:100%}input[type=password]::-ms-clear,input[type=password]::-ms-reveal{display:none}"]
            }] }
];
/** @nocollapse */
PasswordComponent.ctorParameters = () => [];
PasswordComponent.propDecorators = {
    label: [{ type: Input }],
    isRequired: [{ type: Input }],
    isDisabled: [{ type: Input }],
    password: [{ type: Input }],
    pwdCriteria: [{ type: Input }],
    minLen: [{ type: Input }],
    maxLen: [{ type: Input }],
    errorMessages: [{ type: Input }],
    showPasswordStrength: [{ type: Input }],
    objectID: [{ type: Input }],
    passwordChange: [{ type: Output }],
    blurEvent: [{ type: Output }],
    onPaste: [{ type: HostListener, args: ['document:paste', ['$event'],] }]
};
if (false) {
    /** @type {?} */
    PasswordComponent.prototype.label;
    /** @type {?} */
    PasswordComponent.prototype.isRequired;
    /** @type {?} */
    PasswordComponent.prototype.isDisabled;
    /** @type {?} */
    PasswordComponent.prototype.password;
    /** @type {?} */
    PasswordComponent.prototype.pwdCriteria;
    /** @type {?} */
    PasswordComponent.prototype.minLen;
    /** @type {?} */
    PasswordComponent.prototype.maxLen;
    /** @type {?} */
    PasswordComponent.prototype.errorMessages;
    /** @type {?} */
    PasswordComponent.prototype.showPasswordStrength;
    /** @type {?} */
    PasswordComponent.prototype.objectID;
    /** @type {?} */
    PasswordComponent.prototype.passwordChange;
    /** @type {?} */
    PasswordComponent.prototype.blurEvent;
    /** @type {?} */
    PasswordComponent.prototype.hideValue;
    /** @type {?} */
    PasswordComponent.prototype.pswdStrength;
    /** @type {?} */
    PasswordComponent.prototype.strengthPercentage;
    /** @type {?} */
    PasswordComponent.prototype.errMsg;
    /**
     * @type {?}
     * @private
     */
    PasswordComponent.prototype.requiredMsgSeg;
    /**
     * @type {?}
     * @private
     */
    PasswordComponent.prototype.minLenMsgSeg1;
    /**
     * @type {?}
     * @private
     */
    PasswordComponent.prototype.minLenMsgSeg2;
    /**
     * @type {?}
     * @private
     */
    PasswordComponent.prototype.criteriaMsg;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFzc3dvcmQuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vbW9oLWNvbW1vbi1saWIvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9wYXNzd29yZC9wYXNzd29yZC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsS0FBSyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsWUFBWSxFQUF3QixVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDL0gsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQ2hELE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUMxRCxPQUFPLEtBQUssT0FBTyxNQUFNLFFBQVEsQ0FBQzs7OztNQUc1QixNQUFNLEdBQUcsT0FBTzs7Ozs7Ozs7Ozs7QUFXdEIsc0NBSUM7OztJQUhDLG9DQUFrQjs7SUFDbEIscUNBQW1COztJQUNuQixvQ0FBa0I7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQThCcEIsTUFBTSxPQUFPLGlCQUFrQixTQUFRLElBQUk7SUFpQ3pDO1FBQ0UsS0FBSyxFQUFFLENBQUM7O1FBL0JELFVBQUssR0FBVyxVQUFVLENBQUM7UUFDM0IsZUFBVSxHQUFZLElBQUksQ0FBQztRQUMzQixlQUFVLEdBQVksS0FBSyxDQUFDO1FBRzVCLFdBQU0sR0FBWSxHQUFHLENBQUM7UUFDdEIsV0FBTSxHQUFZLElBQUksQ0FBQztRQUV2Qix5QkFBb0IsR0FBWSxLQUFLLENBQUM7UUFDdEMsYUFBUSxHQUFXLFdBQVcsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDOztRQUk5QyxtQkFBYyxHQUF5QixJQUFJLFlBQVksRUFBVSxDQUFDO1FBQ2xFLGNBQVMsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDOztRQUdsQyxjQUFTLEdBQUcsSUFBSSxDQUFDO1FBRWpCLHVCQUFrQixHQUFHLENBQUMsQ0FBQzs7UUFL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OztJQW5GM0Msa0NBQW9DOztJQUNwQyx1Q0FBb0M7O0lBQ3BDLHVDQUFxQzs7SUFDckMscUNBQTBCOztJQUMxQix3Q0FBc0M7O0lBQ3RDLG1DQUErQjs7SUFDL0IsbUNBQWdDOztJQUNoQywwQ0FBeUM7O0lBQ3pDLGlEQUErQzs7SUFDL0MscUNBQXdEOztJQUl4RCwyQ0FBNEU7O0lBQzVFLHNDQUF5Qzs7SUFHekMsc0NBQXdCOztJQUN4Qix5Q0FBNEI7O0lBQzVCLCtDQUE4Qjs7SUFFOUIsbUNBQWdDOzs7OztJQUdoQywyQ0FBaUQ7Ozs7O0lBQ2pELDBDQUFxRDs7Ozs7SUFDckQsMENBQXlEOzs7OztJQUN6RCx3Q0FBOEQiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSW5wdXQsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBIb3N0TGlzdGVuZXIsIE9uQ2hhbmdlcywgRGlyZWN0aXZlLCBmb3J3YXJkUmVmIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBCYXNlIH0gZnJvbSAnLi4vLi4vLi4vbW9kZWxzL3NyYy9iYXNlJztcbmltcG9ydCB7IENvbnRyb2xDb250YWluZXIsIE5nRm9ybSB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcbmltcG9ydCAqIGFzIHp4Y3Zibl8gZnJvbSAnenhjdmJuJztcbi8vIEF3a3dhcmQgbmVjZXNzYXJ5IHdvcmthcm91bmQgZHVlIHRvIGJ1ZyBpbiBidWlsZCB0b29sc1xuLy8gaHR0cHM6Ly9naXRodWIuY29tL2p2YW5kZW1vL2dlbmVyYXRvci1hbmd1bGFyMi1saWJyYXJ5L2lzc3Vlcy8yMjEjaXNzdWVjb21tZW50LTM1NTk0NTIwN1xuY29uc3QgenhjdmJuID0genhjdmJuXztcblxuLyoqXG4gKiBJbnRlcmZhY2UgZm9yIHBhc3NpbmcgaW4gZXJyb3IgbWVzc2FnZXNcbiAqIEV4YW1wbGU6XG4gKiAgZXJyb3JNZXNzYWdlcyA9IHtcbiAqICAgICAgIHJlcXVpcmVkOiB0aGlzLmNvbXBvbmVudExhYmVsICsgJyBpcyByZXF1aXJlZC4nLFxuICogICAgICAgbWluTGVuZ3RoOiB0aGlzLmNvbXBvbmVudExhYmVsICsgJyBtdXN0IGJlICcgKyB0aGlzLm1pbkxlbiArICcgY2hhcmFjdGVycy4nLFxuICogICAgICAgY3JpdGVyaWE6IHRoaXMuY29tcG9uZW50TGFiZWwgKyAnIGRvZXMgbm90IG1lZXQgcGFzc3dvcmQgY3JpdGVyaWEuJ1xuICogICAgIH1cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBQYXNzd29yZEVycm9yTXNnIHtcbiAgcmVxdWlyZWQ/OiBzdHJpbmc7XG4gIG1pbkxlbmd0aD86IHN0cmluZztcbiAgY3JpdGVyaWE/OiBzdHJpbmc7XG59XG4vKipcbiAqIFBhc3N3b3JkQ29tcG9uZW50IGlzIGEgdGV4dCBpbnB1dCBmb3IgYSB1c2VyJ3MgcGFzc3dvcmQuIEl0IGluY2x1ZGVzOlxuICpcbiAqIC0gQSBwYXNzd29yZCBzdHJlbmd0aCBiYXJcbiAqIC0gTWluaW11bSBsZW5ndGggdmFsaWRhdGlvbnNcbiAqXG4gKiBOb3RlIC0gaWYgeW91ciBhcHBsaWNhdGlvbiBoYXMgcmVxdWlyZW1lbnRzIHRvIGNoZWNrIHRoaW5ncyBsaWtlIHVzZXJuYW1lIGlzIG5vdFxuICogcHJlc2VudCBpbiBwYXNzd29yZCwgd2UgcmVjb21tZW5kIGRvaW5nIHRoaXMgaW4gdGhlIChwYXNzd29yZENoYW5nZSkgY2FsbGJhY2suXG4gKlxuICogQGV4YW1wbGVcbiAqICAgICAgIDxjb21tb24tcGFzc3dvcmQgY29tcG9uZW50TGFiZWw9XCJ7e25ld1B3ZExhYmVsfX1cIlxuICogICAgICAgICAgICAgICAgICAgICAgW3Nob3dQYXNzd29yZFN0cmVuZ3RoXT1cInRydWVcIlxuICogICAgICAgICAgICAgICAgICAgICAgW21pbkxlbl09XCJwd2RNaW5MZW5cIlxuICogICAgICAgICAgICAgICAgICAgICAgW3B3ZENyaXRlcmlhXT1cInB3ZFZhbGlkQ2hhcnNcIlxuICogICAgICAgICAgICAgICAgICAgICAgW3Bhc3N3b3JkXT1cImRhdGEucGFzc3dvcmRcIlxuICogICAgICAgICAgICAgICAgICAgICAgKHBhc3N3b3JkQ2hhbmdlKT1cInNldE5ld1Bhc3N3b3JkKCRldmVudClcIj48L2NvbW1vbi1wYXNzd29yZD5cbiAqXG4gKiBAZXhwb3J0XG4gKi9cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2NvbW1vbi1wYXNzd29yZCcsXG4gIHRlbXBsYXRlVXJsOiAnLi9wYXNzd29yZC5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL3Bhc3N3b3JkLmNvbXBvbmVudC5zY3NzJ10sXG4gIC8qIFJlLXVzZSB0aGUgc2FtZSBuZ0Zvcm0gdGhhdCBpdCdzIHBhcmVudCBpcyB1c2luZy4gVGhlIGNvbXBvbmVudCB3aWxsIHNob3dcbiAgICogdXAgaW4gaXRzIHBhcmVudHMgYHRoaXMuZm9ybWAsIGFuZCB3aWxsIGF1dG8tdXBkYXRlIGB0aGlzLmZvcm0udmFsaWRgXG4gICAqL1xuICB2aWV3UHJvdmlkZXJzOiBbIHsgcHJvdmlkZTogQ29udHJvbENvbnRhaW5lciwgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gTmdGb3JtICkgfSBdXG59KVxuZXhwb3J0IGNsYXNzIFBhc3N3b3JkQ29tcG9uZW50IGV4dGVuZHMgQmFzZSBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzIHtcblxuICAvLyBJbnB1dHMgZm9yIHRoZSBjb21wb25lbnRcbiAgQElucHV0KCkgbGFiZWw6IHN0cmluZyA9ICdQYXNzd29yZCc7XG4gIEBJbnB1dCgpIGlzUmVxdWlyZWQ6IGJvb2xlYW4gPSB0cnVlO1xuICBASW5wdXQoKSBpc0Rpc2FibGVkOiBib29sZWFuID0gZmFsc2U7XG4gIEBJbnB1dCgpIHBhc3N3b3JkOiBzdHJpbmc7XG4gIEBJbnB1dCgpIHB3ZENyaXRlcmlhOiBzdHJpbmcgfCBSZWdFeHA7XG4gIEBJbnB1dCgpIG1pbkxlbjogc3RyaW5nICA9ICc4JztcbiAgQElucHV0KCkgbWF4TGVuOiBzdHJpbmcgID0gJzMyJztcbiAgQElucHV0KCkgZXJyb3JNZXNzYWdlczogUGFzc3dvcmRFcnJvck1zZztcbiAgQElucHV0KCkgc2hvd1Bhc3N3b3JkU3RyZW5ndGg6IGJvb2xlYW4gPSBmYWxzZTtcbiAgQElucHV0KCkgb2JqZWN0SUQ6IHN0cmluZyA9ICdwYXNzd29yZF8nICsgdGhpcy5vYmplY3RJZDtcblxuXG4gIC8vIE91dHB1dCBmcm9tIHRoZSBjb21wb25lbnRcbiAgQE91dHB1dCgpIHBhc3N3b3JkQ2hhbmdlOiBFdmVudEVtaXR0ZXI8c3RyaW5nPiA9IG5ldyBFdmVudEVtaXR0ZXI8c3RyaW5nPigpO1xuICBAT3V0cHV0KCkgYmx1ckV2ZW50ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuXG4gIC8vIEZsYWcgZm9yIHRoZSBmYS1leWUgdG8gc2hvdyBvciBoaWRlIHBhc3N3b3JkXG4gIHB1YmxpYyBoaWRlVmFsdWUgPSB0cnVlO1xuICBwdWJsaWMgcHN3ZFN0cmVuZ3RoOiBudW1iZXI7XG4gIHB1YmxpYyBzdHJlbmd0aFBlcmNlbnRhZ2UgPSAwO1xuXG4gIHB1YmxpYyBlcnJNc2c6IFBhc3N3b3JkRXJyb3JNc2c7XG5cbiAgLy8gZGVmYXVsdCBtZXNzYWdlc1xuICBwcml2YXRlIHJlcXVpcmVkTXNnU2VnOiBzdHJpbmcgPSAnIGlzIHJlcXVpcmVkLic7XG4gIHByaXZhdGUgbWluTGVuTXNnU2VnMTogc3RyaW5nID0gJyBtdXN0IGJlIGF0IGxlYXN0ICc7XG4gIHByaXZhdGUgbWluTGVuTXNnU2VnMjogc3RyaW5nID0gJyBjaGFyYWN0ZXJzIGluIGxlbmd0aC4nO1xuICBwcml2YXRlIGNyaXRlcmlhTXNnOiBzdHJpbmcgPSAnIGNvbnRhaW5zIGludmFsaWQgY2hhcmFjdGVycy4nO1xuXG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKTtcbiAgfVxuXG4gIG5nT25Jbml0KCkge1xuXG4gICAgLy8gU2V0IGRlZmF1bHQgbWVzc2FnZXNcbiAgICB0aGlzLmVyck1zZyA9ICAgIHtcbiAgICAgIHJlcXVpcmVkOiB0aGlzLmxhYmVsICsgdGhpcy5yZXF1aXJlZE1zZ1NlZyxcbiAgICAgIG1pbkxlbmd0aDogdGhpcy5sYWJlbCArIHRoaXMubWluTGVuTXNnU2VnMSArIHRoaXMubWluTGVuICsgdGhpcy5taW5MZW5Nc2dTZWcyLFxuICAgICAgY3JpdGVyaWE6IHRoaXMubGFiZWwgKyB0aGlzLmNyaXRlcmlhTXNnXG4gICAgfTtcblxuICAgIC8vIFJlcGxhY2UgZGVmYXVsdCBtZXNzYWdlIGlmIHByb3ZpZGVkXG4gICAgaWYgKCB0aGlzLmVycm9yTWVzc2FnZXMgKSB7XG5cbiAgICAgIGlmICggdGhpcy5lcnJvck1lc3NhZ2VzLnJlcXVpcmVkICkge1xuICAgICAgICB0aGlzLmVyck1zZy5yZXF1aXJlZCA9IHRoaXMuZXJyb3JNZXNzYWdlcy5yZXF1aXJlZDtcbiAgICAgIH1cblxuICAgICAgaWYgKCB0aGlzLmVycm9yTWVzc2FnZXMubWluTGVuZ3RoICkge1xuICAgICAgICB0aGlzLmVyck1zZy5taW5MZW5ndGggPSB0aGlzLmVycm9yTWVzc2FnZXMubWluTGVuZ3RoO1xuICAgICAgfVxuXG4gICAgICBpZiAoIHRoaXMuZXJyb3JNZXNzYWdlcy5jcml0ZXJpYSApIHtcbiAgICAgICAgdGhpcy5lcnJNc2cuY3JpdGVyaWEgPSB0aGlzLmVycm9yTWVzc2FnZXMuY3JpdGVyaWE7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgbmdPbkNoYW5nZXMoY2hhbmdlcykge1xuICAgIGlmIChjaGFuZ2VzLnBhc3N3b3JkICYmIHRoaXMucGFzc3dvcmQpIHtcblxuICAgICAgLy8gQ2hlY2sgc3RyZW5ndGggb2YgcGFzc3dvcmRcbiAgICAgIHRoaXMucHN3ZFN0cmVuZ3RoID0gdGhpcy5nZXRQYXNzd29yZFN0cmVuZ3RoKCB0aGlzLnBhc3N3b3JkICk7XG4gICAgICB0aGlzLnN0cmVuZ3RoUGVyY2VudGFnZSA9ICgodGhpcy5wc3dkU3RyZW5ndGggKyAxKSAvIDUgKSAqIDEwMDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUGFzc2VzIHRoZSB2YWx1ZSBlbnRlcmVkIGJhY2sgdG8gdGhlIGNhbGxpbmcgY29tcG9uZW50XG4gICAqIEBwYXJhbSBwYXNzd29yZCB2YWx1ZSB0aGUgd2FzIGVudGVyZWQgYnlcbiAgICovXG4gIHNldFBhc3N3b3JkKCBwYXNzd29yZDogc3RyaW5nICkge1xuICAgIHRoaXMucGFzc3dvcmRDaGFuZ2UuZW1pdCggcGFzc3dvcmQgKTtcbiAgfVxuXG4gIG9uSW5wdXRCbHVyKCRldmVudCkge1xuICAgIGNvbnNvbGUubG9nKCAnb25CbHVyOiAnLCBldmVudCApO1xuICAgIHRoaXMuYmx1ckV2ZW50LmVtaXQoIGV2ZW50ICk7XG4gIH1cblxuICAvLyBQcmV2ZW50IHVzZXIgZnJvbSBwYXN0aW5nIGRhdGEgaW50byB0aGUgdGV4dCBib3hcbiAgQEhvc3RMaXN0ZW5lciggJ2RvY3VtZW50OnBhc3RlJywgWyckZXZlbnQnXSApXG4gIG9uUGFzdGUoIGV2ZW50ICkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgc3RyZW5ndGggb2YgdGhlIHBhc3N3b3JkXG5cbiAgICogICAgMCA9IHRvbyBndWVzc2FibGU6IHJpc2t5IHBhc3N3b3JkLiAoZ3Vlc3NlcyA8IDEwXjMpXG4gICAqICAgIDEgPSB2ZXJ5IGd1ZXNzYWJsZTogcHJvdGVjdGlvbiBmcm9tIHRocm90dGxlZCBvbmxpbmUgYXR0YWNrcy4gKGd1ZXNzZXMgPCAxMF42KVxuICAgKiAgICAyID0gc29tZXdoYXQgZ3Vlc3NhYmxlOiBwcm90ZWN0aW9uIGZyb20gdW50aHJvdHRsZWQgb25saW5lIGF0dGFja3MuIChndWVzc2VzIDwgMTBeOClcbiAgICogICAgMyA9IHNhZmVseSB1bmd1ZXNzYWJsZTogbW9kZXJhdGUgcHJvdGVjdGlvbiBmcm9tIG9mZmxpbmUgc2xvdy1oYXNoIHNjZW5hcmlvLiAoZ3Vlc3NlcyA8IDEwXjEwKVxuICAgKiAgICA0ID0gdmVyeSB1bmd1ZXNzYWJsZTogc3Ryb25nIHByb3RlY3Rpb24gZnJvbSBvZmZsaW5lIHNsb3ctaGFzaCBzY2VuYXJpby4gKGd1ZXNzZXMgPj0gMTBeMTApXG4gICAqXG4gICAqICBodHRwczovL2dpdGh1Yi5jb20vZHJvcGJveC96eGN2Ym5cbiAgICovXG4gIHByaXZhdGUgZ2V0UGFzc3dvcmRTdHJlbmd0aCggcGFzc3dvcmQ6IHN0cmluZyApOiBudW1iZXIge1xuICAgIC8vIFBhc3N3b3JkIHN0cmVuZ3RoIGZlZWRiYWNrXG4gICAgY29uc3QgcHN3ZEZlZWRiYWNrID0genhjdmJuKCBwYXNzd29yZCApO1xuICAgIHJldHVybiBwc3dkRmVlZGJhY2suc2NvcmU7XG4gIH1cbn1cbiJdfQ==